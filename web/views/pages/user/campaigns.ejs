<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campaigns - ClipHub</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-zinc-950 text-gray-100 min-h-screen">
  <%- include('../../partials/navbar', { user }) %>
  
  <div class="max-w-7xl mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-[#E31E24] mb-6">Campaigns</h1>
    
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-[#E31E24] mb-4">My Campaigns</h2>
      <% if (joinedCampaigns.length > 0) { %>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <% joinedCampaigns.forEach(campaign => { %>
            <div class="bg-zinc-900 rounded-lg p-6">
              <h3 class="text-xl font-bold mb-2"><%= campaign.name %></h3>
              <p class="text-gray-400 text-sm mb-4"><%= campaign.description %></p>
              <div class="space-y-2 mb-4">
                <p class="text-sm"><span class="text-gray-400">Type:</span> <%= campaign.type %></p>
                <p class="text-sm"><span class="text-gray-400">Rate:</span> <span class="text-[#E31E24]">$<%= campaign.rate_per_1k %>/1K</span></p>
                <p class="text-sm"><span class="text-gray-400">My Submissions:</span> <%= campaign.my_submissions %></p>
                <p class="text-sm"><span class="text-gray-400">My Views:</span> <%= campaign.my_views.toLocaleString() %></p>
              </div>
              <a href="/user/submit" class="block text-center bg-[#E31E24] hover:bg-[#B91419] px-4 py-2 rounded">Submit Clip</a>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <div class="bg-zinc-900 rounded-lg p-8 text-center text-gray-400">
          You haven't joined any campaigns yet
        </div>
      <% } %>
    </div>
    
    <div>
      <h2 class="text-2xl font-bold text-[#E31E24] mb-4">Available Campaigns</h2>
      <% if (availableCampaigns.length > 0) { %>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <% availableCampaigns.forEach(campaign => { %>
            <div class="bg-zinc-900 rounded-lg p-6">
              <h3 class="text-xl font-bold mb-2"><%= campaign.name %></h3>
              <p class="text-gray-400 text-sm mb-4"><%= campaign.description %></p>
              <div class="space-y-2 mb-4">
                <p class="text-sm"><span class="text-gray-400">Type:</span> <%= campaign.type %></p>
                <p class="text-sm"><span class="text-gray-400">Rate:</span> <span class="text-[#E31E24]">$<%= campaign.rate_per_1k %>/1K views</span></p>
                <p class="text-sm"><span class="text-gray-400">Members:</span> <%= campaign.member_count %></p>
              </div>
              <button onclick="joinCampaign(<%= campaign.id %>)" class="w-full bg-[#E31E24] hover:bg-[#B91419] px-4 py-2 rounded">Join Campaign</button>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <div class="bg-zinc-900 rounded-lg p-8 text-center text-gray-400">
          No available campaigns at the moment
        </div>
      <% } %>
    </div>
  </div>
  
  <script>
    async function joinCampaign(id) {
      const response = await fetch(`/campaigns/join/${id}`, { method: 'POST' });
      const result = await response.json();
      alert(result.message);
      if (result.success) window.location.reload();
    }
  </script>
</body>
</html>
